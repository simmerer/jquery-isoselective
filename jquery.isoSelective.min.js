// jQuery isoSelective created by Alexander Buddy 'Gatsby' Jones http://www.gatsbyart.com
// update for jQuery 1.9+ and IE8 compatibility by David Simmer http://simmerdesigns.com
function commonAncestor(e){var t=[];var n=Infinity;$(e).each(function(){var e=$(this).parents();t.push(e);n=Math.min(n,e.length)});for(var r in t){t[r]=t[r].slice(t[r].length-n)}for(var r in t[0]){var i=true;for(var s in t){if(t[s][r]!=t[0][r]){i=false;break}}if(i)return t[0][r]}return[]}(function(e){e.fn.isoSelective=function(t){var n=e.extend({},e.fn.isoSelective.defaults,t);return this.each(function(){$this=e(this);var t=e.meta?e.extend({},n,$this.data()):n;e.fn.isoSelective.initializeFiltering(t.linkSelector,t.attrSelector,t.activeClass,t.preventEmpty,t.linkParentID,$this)})};e.fn.isoSelective.initializeFiltering=function(t,r,s,o,u,a){var f=a;var l=new Array;var c=e(t).length;var h=e(t).get(0).tagName;var p=u==undefined?commonAncestor(t):u;for(i=0;i<c;i++){if(e(p).find(h).eq(i).hasClass(s)){l[i]=e(p).find(h).eq(i).attr(r)+", "}else{l[i]=" "}}if(l.indexOf("*, ")!=-1){var d=l.indexOf("*, ");for(g=0;g<l.length;g++){l[g]=""}l[d]="*"}e(t).on("click",function(){var i=e(this).attr(r);var u=e(p).find(h).index(this);if(e(this).attr(r)!="*"){var a=l.indexOf("*");if(a!=-1){l[a]="";e(p).find(h).eq(a).toggleClass(s)}if(l[u]==e(this).attr(r)+", "){l[u]=""}else{l[u]=e(this).attr(r)+", "}e(this).toggleClass(s)}else{if(l[u]=="*, "||l[u]=="*"){l[u]="";e(t).removeClass(s)}else{for(n=0;n<c;n++){l[n]=""}l[u]="*";e(t).removeClass(s);e(this).addClass(s)}}var d=l.join("");var v=d.replace(/\s/g,"");if(v!="*"){v=v.slice(0,-1)}if(v==""){if(o){v="*"}else{v="#nulldiviwthoutapropername"}}e(f).isotope({filter:v});return false})};e.fn.isoSelective.defaults={linkSelector:".filter",attrSelector:"rel",activeClass:"selected"}})(jQuery)